<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>LibraryThing Widget</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

</head>
<body data-bs-theme="dark" class="bg-dark text-light" style="margin:0;">

  <!-- LibraryThing Widget container -->
  <div id="w69450fb97d94f86f72ffd1d030540538"></div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>


  <script
    type="text/javascript"
    charset="UTF-8"
    src="https://www.librarything.com/widget_get.php?userid=vapolyamory&theID=w69450fb97d94f86f72ffd1d030540538"
  ></script>

  <noscript>
    <a href="https://www.librarything.com/profile/vapolyamory">My Library</a> at
    <a href="https://www.librarything.com">LibraryThing</a>
  </noscript>

  <script>
    function reportHeight() {
      var height = Math.ceil(document.body.scrollHeight) + 1;
      parent.postMessage({ type: 'librarythingHeight', height }, '*');
      //console.log('Reported height:', height);
    }

    function waitForAllImages(callback) {
      const imgs = Array.from(document.querySelectorAll('img'));
      if (imgs.length === 0) return callback();

      let loaded = 0;

      const checkDone = () => {
        loaded++;
        if (loaded >= imgs.length) callback();
      };

      imgs.forEach(img => {
        if (img.complete) {
          checkDone();
        } else {
          img.addEventListener('load', checkDone);
          img.addEventListener('error', checkDone);
        }
      });
    }

    function handleResizing() {
      // Allow layout to settle first
      setTimeout(waitForAllImages(() => {
        reportHeight();
      }), 100);
      
    }

    // Watch for new images added dynamically
    const observer = new MutationObserver(() => {
      handleResizing();
    });

    observer.observe(document.body, {
      childList: true,
      subtree: true,
    });

    window.addEventListener('load', handleResizing);
    window.addEventListener('resize', handleResizing);

  </script>


</body>
</html>
